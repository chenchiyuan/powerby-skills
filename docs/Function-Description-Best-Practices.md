# 功能点描述最佳实践指南

## 概述

本文档提供了PowerBy框架下功能点描述的标准格式和最佳实践，确保PRD文档中的功能点描述清晰、准确、可执行。

## 标准格式

### 8要素结构

每个功能点必须包含以下8个要素：

```
##### FX.X [功能点名称] [优先级]
**需求来源**: US-X (来自哪个用户故事)
**功能描述**: [用1-2句话清晰描述功能要做什么]
**用户输入**:
- [输入项1]: [类型] ([必选/可选], 默认值)
- [输入项2]: [类型] ([必选/可选], 默认值)
**系统输出**:
- [输出项1]: [类型] ([描述])
- [输出项2]: [类型] ([描述])
**关键约束**:
- [约束条件1]
- [约束条件2]
**验收标准**:
- [ ] [可验证的标准1]
- [ ] [可验证的标准2]
- [ ] [可验证的标准3]
**依赖关系**: [无 / 功能点A / 功能点A, B]
**预估工时**: X人天
```

## 详细说明

### 1. 需求来源 (Requirements Source)

**格式**: `US-X`
**说明**: 明确标注该功能点来自哪个用户故事
**示例**:
- `US-1` - 来自用户故事1
- `US-2` - 来自用户故事2

**注意事项**:
- 必须与附录中的用户故事清单对应
- 一个功能点可以关联多个用户故事
- 多个功能点可以来自同一个用户故事

### 2. 功能描述 (Function Description)

**格式**: 1-2句话，动词开头
**模板**: `[执行什么操作] + [为了什么目的]`

**好例子**:
- ✅ "从单个DEX获取指定交易对的实时价格"
- ✅ "并行查询多个DEX价格并自动排序展示"
- ✅ "计算扣除所有费用后的实际到手金额"

**避免**:
- ❌ 过于宽泛: "提供价格查询功能"
- ❌ 包含实现细节: "通过API调用获取价格"
- ❌ 描述不完整: "处理价格数据"

### 3. 用户输入 (User Inputs)

**格式**: `- [输入项名称]: [数据类型] ([必选/可选], 默认值)`

**数据类型示例**:
- `String` - 字符串
- `Number` - 数字
- `Boolean` - 布尔值
- `BigNumber` - 大数（区块链场景）
- `Array<String>` - 字符串数组
- `Object` - 对象
- `File` - 文件
- `Date` - 日期

**示例**:
```
用户输入:
- dexId: String (必选, 枚举: ["uniswap-v3", "sushiswap"])
- tokenPair: String (必选, 如 "ETH/USDC")
- amount: Number (可选, 默认 1.0)
- refreshInterval: Number (可选, 默认 5000ms)
```

**注意事项**:
- 明确区分必选和可选
- 提供默认值（如适用）
- 对于枚举类型，列出所有可能值
- 特殊类型（如BigNumber）需要说明精度

### 4. 系统输出 (System Outputs)

**格式**: `- [输出项名称]: [数据类型] ([描述])`

**示例**:
```
系统输出:
- price: BigNumber (价格，精度18位)
- liquidity: BigNumber (池子流动性)
- timestamp: Number (Unix时间戳)
- source: String (数据来源DEX)
- results: Array<PriceResult> (排序后的价格结果)
```

**注意事项**:
- 输出项应该是完整的、用户可感知的结果
- 明确数据精度要求
- 对于复合类型，提供结构说明
- 输出项应该可以直接用于下一步处理

### 5. 关键约束 (Key Constraints)

**类型**:
- **性能约束**: 响应时间、吞吐量等
- **准确性约束**: 精度要求、误差范围等
- **业务约束**: 业务规则限制
- **技术约束**: 技术限制条件
- **安全约束**: 安全相关要求

**示例**:
```
关键约束:
- API响应时间<3秒
- 价格数据时效性≤10秒
- 从合约实时获取最新费率
- 费率数据缓存24小时
- URL安全校验
```

**注意事项**:
- 约束条件应该是具体的、可测量的
- 避免模糊的描述，如"尽可能快"
- 约束应该是强制性的，不是建议性的
- 重要约束可以提升为验收标准

### 6. 验收标准 (Acceptance Criteria)

**格式**: `- [ ] [可验证的标准]`

**标准类型**:
- **功能正确性**: 功能是否按预期工作
- **性能要求**: 是否满足性能指标
- **边界条件**: 异常情况的处理
- **用户体验**: 交互是否符合预期

**示例**:
```
验收标准:
- [ ] 能查询主流ERC-20交易对价格
- [ ] 价格与链上实际成交价格误差<2%
- [ ] 支持3个主流DEX
- [ ] API超时时间为3秒
- [ ] 输入无效DEX，抛出ValidationError
```

**SMART原则**:
- **S**pecific - 具体明确
- **M**easurable - 可测量
- **A**chievable - 可实现
- **R**elevant - 相关
- **T**ime-bound - 有时限

**注意事项**:
- 每个功能点至少3个验收标准
- 标准应该是可测试的
- 优先测试正常流程，再测试异常情况
- 标准之间应该是独立的

### 7. 依赖关系 (Dependencies)

**格式**:
- 无依赖: `无`
- 单个依赖: `功能点A`
- 多个依赖: `功能点A, 功能点B`

**依赖类型**:
- **数据依赖**: 需要依赖功能点的输出数据
- **逻辑依赖**: 业务逻辑上的依赖关系
- **UI依赖**: 需要依赖功能的UI组件

**示例**:
```
依赖关系: F1.1
说明: 需要F1.1的单DEX查询能力作为基础

依赖关系: F1.2, F2.1, F2.2
说明: 需要F1.2的价格数据、F2.1的费率数据和F2.2的滑点数据
```

**注意事项**:
- 依赖关系应该是单向的，避免循环依赖
- 明确说明依赖的原因
- 可以通过依赖关系图可视化

### 8. 预估工时 (Estimated Effort)

**单位**: 人天 (一个开发人员一天的工作量)

**估算方法**:
- 基于历史数据
- 使用功能点复杂度评估
- 考虑技术难度和不确定性

**复杂度分级**:
- **低**: 1-3人天，简单功能，标准实现
- **中**: 4-7人天，中等复杂度，需要一定设计
- **高**: 8-15人天，复杂功能，创新性实现
- **很高**: 15+人天，极高复杂度，可能需要拆分

**示例**:
```
预估工时: 3人天
说明: 标准的数据查询功能，有成熟的API可以直接调用

预估工时: 8人天
说明: 需要算法设计和性能优化，技术难度较高
```

**注意事项**:
- 估算应该包含编码、测试、调试时间
- 考虑不确定性，增加缓冲时间
- 定期回顾和更新估算准确性

## 优先级说明

### P0 (Must Have)
- **定义**: MVP的核心功能，没有它产品价值无法体现
- **特征**:
  - 必须包含在MVP中
  - 用户完成核心任务必需
  - 估算总工时占比不超过80%
- **示例**: 核心业务功能、关键用户流程

### P1 (Should Have)
- **定义**: 重要功能，但不是MVP必需
- **特征**:
  - 可以推迟到下一个迭代
  - 增强用户体验
  - 不影响核心价值验证
- **示例**: 高级功能、性能优化、辅助工具

### P2 (Could Have)
- **定义**: 锦上添花的功能
- **特征**:
  - 可以后续迭代考虑
  - 不是必需的
  - 基于用户反馈决定是否实现
- **示例**: 增强功能、酷炫特性、长期规划

## 模块化原则

### 模块划分标准
1. **业务价值聚合**: 相同业务价值的功能点归为一个模块
2. **用户流程聚合**: 同一用户流程的功能点归为一个模块
3. **技术组件聚合**: 依赖相同技术组件的功能点归为一个模块

### 模块命名规范
- 使用名词短语
- 体现模块的核心价值
- 简洁明了（2-4个词）

**好例子**:
- ✅ 价格聚合模块
- ✅ 费用计算模块
- ✅ 交易执行模块

**避免**:
- ❌ 功能模块1
- ❌ 杂项功能
- ❌ 一些其他功能

## 依赖关系管理

### 依赖关系图绘制规则

```
FX.A (功能点A名称)
  ↓
FX.B (功能点B名称)
  ↓
FX.C (功能点C名称)

或者并行依赖:

FX.A (功能点A名称)
  ↓
FX.B (功能点B名称) ─┬─ FX.D (功能点D名称)
  ↓               │
FX.C (功能点C名称) ─┘
```

### 依赖关系说明格式

```
依赖关系说明:
- FX.B 依赖 FX.A 完成[什么能力]
- FX.C 依赖 FX.A、FX.B 完成[什么能力]
- FX.D 依赖 FX.B、FX.D 完成[什么能力]
```

## 常见问题与解答

### Q1: 功能点粒度如何把握？
**A**: 一个功能点应该：
- 可以独立实现和测试
- 有明确的输入和输出
- 预估工时不超过5人天（否则考虑拆分）

### Q2: 如何处理复杂的依赖关系？
**A**:
- 绘制依赖关系图
- 识别关键路径
- 考虑并行开发的可能性
- 将复杂依赖分解为多个简单依赖

### Q3: 验收标准应该写多少条？
**A**: 建议3-7条，包含：
- 1-2条正常流程标准
- 1-2条异常处理标准
- 1-2条性能/质量标准
- 1条用户体验标准

### Q4: 如何处理功能点之间的交叉依赖？
**A**:
- 明确主依赖和次依赖
- 定义清晰的接口契约
- 优先实现被依赖的功能点
- 通过抽象减少直接依赖

### Q5: 预估工时不准怎么办？
**A**:
- 记录实际工时和预估的差异
- 分析偏差原因
- 更新估算方法和标准
- 在下一个项目中应用经验

## 质量检查清单

在完成功能点描述后，检查以下项目：

- [ ] 是否明确标注了需求来源？
- [ ] 功能描述是否清晰、简洁？
- [ ] 用户输入是否完整、明确？
- [ ] 系统输出是否可感知、有用？
- [ ] 关键约束是否具体、可测量？
- [ ] 验收标准是否符合SMART原则？
- [ ] 依赖关系是否正确、无循环？
- [ ] 预估工时是否合理？
- [ ] 优先级是否与业务价值匹配？
- [ ] 模块划分是否合理？

## 参考资料

- [PRD模板](../templates/prd-template.md)
- [功能点描述示例](../demo-prd.md)
- [PowerBy生命周期框架](./powerby-lifecycle-overview.md)
- [MVP优先级评估指南](../skills/mvp-prioritization/SKILL.md)

---

**版本**: v1.0.0
**最后更新**: 2025-12-17
**维护者**: PowerBy产品团队

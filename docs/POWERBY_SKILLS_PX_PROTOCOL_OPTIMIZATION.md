# PowerBy Skills - Px执行协议优化建议

**版本**: v1.0.0
**创建日期**: 2025-12-19
**目标**: 将Px执行协议的1+N模式应用到所有相关技能中
**原则**: 基于奥卡姆剃刀原则，最小侵入式优化

---

## 📋 优化概览

### 当前问题
- 现有技能没有应用1+N执行模式
- 存在"大爆炸"式一次性输出问题
- 缺乏任务拆解和增量执行的规范

### 优化目标
- 在每个P阶段开始时强制任务拆解
- 改分步执行，完成一个标记一个
- 确保执行过程透明、可追溯
- 避免一次性完整交付

### 涉及技能
- ✅ powerby-product (P1, P2)
- ✅ powerby-architect (P3, P4)
- ✅ powerby-engineer (P5, P6)
- ✅ powerby-code-review (P7)
- ✅ powerby-command (指令模板)
- ✅ powerby-fullstack (快速流程)

---

## 1. powerby-product 优化 (P1, P2)

### 1.1 当前问题
- 使用循环式协作模式，没有明确任务拆解
- 容易一次性输出完整PRD
- 缺乏增量执行规范

### 1.2 优化方案

#### P1阶段优化

**修改前**:
```markdown
#### Step 1: 首次回合致意与模板请求
- 向用户致意
- 请求初始输入
- 循环直到两份清单均为空
```

**修改后**:
```markdown
#### Step 1: 任务拆解 (遵循1+N模式)
**强制要求**: 进入P1阶段后，首先拆解本阶段的子任务清单

**标准话术**:
"理解。我将帮助您执行P1阶段。按照Px执行协议，我先拆解本阶段的子任务清单：

## P1: 需求定义 🔄 (进行中)

### 子任务列表
- [ ] 收集需求原始输入
- [ ] 定义功能规格框架
- [ ] 拆解MVP功能点
- [ ] 标记P0/P1/P2优先级
- [ ] 明确范围边界
- [ ] 生成待决策清单

现在开始执行第一个子任务：收集需求原始输入"

#### Step 2: 分步执行
- 按子任务清单逐项执行
- 完成一个标记[x]一个
- 每个子任务完成后简短总结
- 遇到阻塞记录并继续下一个

#### Step 3: 合规检查
- 对照Gate 1验收标准
- 确保PRD符合阶段标准
```

### 1.3 具体修改点

#### 在SKILL.md中添加

```markdown
### 🛠️ 执行步骤 (遵循Px执行协议)

#### Step 1: 任务拆解 (必须执行)
进入P1阶段后的第一个动作必须是拆解子任务清单，记录在tasks.md中。

**标准话术**:
"理解。我将帮助您执行P1阶段。按照Px执行协议，我先拆解本阶段的子任务清单..."

#### Step 2: 分步执行
按照拆解后的清单逐一执行，完成一个标记[x]。

#### Step 3: 合规检查
对照Gate 1验收标准进行自测。
```

#### 修改循环逻辑

**删除**:
- 复杂的循环协作模式
- 一次性输出完整PRD

**改为**:
- 分步执行模式
- 每个子任务独立完成
- 增量式PRD完善

---

## 2. powerby-architect 优化 (P3, P4)

### 2.1 当前问题
- 有结构化步骤，但缺乏任务拆解
- 可能一次性输出完整调研报告
- 没有强调增量执行

### 2.2 优化方案

#### P3阶段优化

**修改前**:
```markdown
#### Step 1: 需求解读与目标对齐
#### Step 2: 技术调研分析
#### Step 3: Gate 3检查
```

**修改后**:
```markdown
#### Step 1: 任务拆解 (遵循1+N模式)
**标准话术**:
"理解。我将帮助您执行P3阶段。按照Px执行协议，我先拆解本阶段的子任务清单：

## P3: 技术调研 🔄 (进行中)

### 子任务列表
- [ ] 需求解读与目标对齐
- [ ] 技术栈选型调研
- [ ] 关键技术决策点分析
- [ ] 技术风险评估
- [ ] Gate 3检查

现在开始执行第一个子任务：需求解读与目标对齐"

#### Step 2-6: 分步执行
- 按子任务清单逐项执行
- 每个子任务完成后标记[x]
- 增量输出调研结果

#### Step 7: 合规检查
- 对照Gate 3验收标准
- 确保调研完整性
```

### 2.3 具体修改点

#### 在SKILL.md中添加

```markdown
### 🛠️ 执行步骤 (遵循Px执行协议)

#### Step 1: 任务拆解
进入P3阶段后，首先拆解本阶段的子任务清单。

**标准话术**:
[同上]

#### Step 2-6: 分步执行
按照拆解后的清单逐一执行，完成一个标记[x]。

#### Step 7: 合规检查
对照Gate 3验收标准进行自测。
```

---

## 3. powerby-engineer 优化 (P5, P6)

### 3.1 当前问题
- 有4阶段研发协议，但没有应用1+N模式
- 任务规划可能一次性完成
- 缺乏增量执行规范

### 3.2 优化方案

#### P5阶段优化

**修改前**:
```markdown
#### Step 1: 需求与架构对齐分析
#### Step 2: 开发任务生成
#### Step 3: 技术方案评估
#### Step 4: Gate 5检查
```

**修改后**:
```markdown
#### Step 1: 任务拆解 (遵循1+N模式)
**标准话术**:
"理解。我将帮助您执行P5阶段。按照Px执行协议，我先拆解本阶段的子任务清单：

## P5: 开发规划 🔄 (进行中)

### 子任务列表
- [ ] 需求与架构对齐分析
- [ ] 基础任务生成
- [ ] 关键技术方案评估
- [ ] 任务依赖关系梳理
- [ ] Gate 5检查

现在开始执行第一个子任务：需求与架构对齐分析"

#### Step 2-6: 分步执行
- 按子任务清单逐项执行
- 每个子任务完成后标记[x]
- 增量完善tasks.md

#### Step 7: 合规检查
- 对照Gate 5验收标准
- 确保规划完整性
```

### 3.3 具体修改点

#### 在SKILL.md中添加

```markdown
### 🛠️ 执行步骤 (遵循Px执行协议)

#### Step 1: 任务拆解
进入P5阶段后，首先拆解本阶段的子任务清单。

**标准话术**:
[同上]

#### Step 2-6: 分步执行
按照拆解后的清单逐一执行，完成一个标记[x]。

#### Step 7: 合规检查
对照Gate 5验收标准进行自测。
```

---

## 4. powerby-code-review 优化 (P7)

### 4.1 优化方案

```markdown
#### Step 1: 任务拆解 (遵循1+N模式)
**标准话术**:
"理解。我将帮助您执行P7阶段。按照Px执行协议，我先拆解本阶段的子任务清单：

## P7: 质量审查 🔄 (进行中)

### 子任务列表
- [ ] 一致性与范围审计
- [ ] 实现完整性与真实性审计
- [ ] 设计哲学与代码质量审计
- [ ] 测试与健壮性审计
- [ ] Checklist验证审计
- [ ] Gate 5检查

现在开始执行第一个子任务：一致性与范围审计"

#### Step 2-7: 分步执行
- 按子任务清单逐项执行
- 每个子任务完成后标记[x]
- 增量输出审查结果

#### Step 8: 合规检查
- 对照Gate 5验收标准
- 确保审查完整性
```

---

## 5. powerby-command 优化

### 5.1 指令模板更新

#### powerby-define.md 优化

**修改前**:
```markdown
---
description: 需求定义+澄清 - 输入需求，生成PRD和功能点清单，融合澄清过程，自动初始化项目结构
handoffs:
  - label: Define+Clarify Requirements
    agent: powerby-product
    prompt: 首先执行自动初始化检查...
      然后基于用户输入的需求，生成完整的PRD文档和功能点清单，并融合澄清过程消除模糊点。
```

**修改后**:
```markdown
---
description: 需求定义+澄清 - 输入需求，生成PRD和功能点清单，融合澄清过程，自动初始化项目结构，遵循1+N执行模式
handoffs:
  - label: Define+Clarify Requirements
    agent: powerby-product
    prompt: 首先执行自动初始化检查：
      1. 检查 .powerby/project.json 是否存在
      2. 检查 docs/constitution.md 是否存在
      3. 如果不存在，从 templates/ 目录复制并创建必要文件

      然后执行P1阶段。按照Px执行协议：
      1. 首先拆解本阶段的子任务清单（记录在tasks.md中）
      2. 逐项执行子任务，完成一个标记[x]一个
      3. 避免一次性输出完整PRD，采用增量式完善

      标准话术：
      "理解。我将帮助您执行P1阶段。按照Px执行协议，我先拆解本阶段的子任务清单..."
```

#### 其他指令模板类似更新

需要更新的指令模板：
- ✅ powerby-research.md (P3)
- ✅ powerby-design.md (P4)
- ✅ powerby-plan.md (P5)
- ✅ powerby-implement.md (P6)
- ✅ powerby-review.md (P7)
- ✅ powerby-quick.md (快速流程)

### 5.2 自动初始化增强

在所有涉及P阶段的指令中添加：

```markdown
### 自动初始化 + 任务拆解
在执行任何P阶段前，系统会自动：
1. 检查项目是否已初始化
2. 如果未初始化，自动创建必要文件
3. 然后要求技能首先拆解任务清单
```

---

## 6. powerby-fullstack 优化 (快速流程)

### 6.1 当前问题
- 快速流程也需要应用1+N模式
- 需要调整子任务颗粒度

### 6.2 优化方案

**修改前**:
```markdown
P0+P1: /powerby.define (自动初始化 + 需求定稿制)
```

**修改后**:
```markdown
P0+P1: /powerby.define (自动初始化 + 需求定稿制 + 任务拆解)

标准执行：
1. 自动初始化检查
2. 拆解P1子任务清单（颗粒度更粗）
3. 分步执行，完成一个标记[x]一个
4. 避免一次性输出完整PRD
```

### 6.3 快速流程子任务示例

```markdown
## P1: 需求定稿制子任务 (快速流程)

### 子任务列表
- [ ] 需求草拟与自检 (90分钟)
  - 生成PRD草案
  - 同步识别模糊点
  - 列出AI待澄清事项清单

- [ ] 交互式澄清 (60分钟)
  - 向用户展示澄清事项
  - 获取回复并实时更新文档

- [ ] 最终确认 (30分钟)
  - 确保所有文档无矛盾
  - 澄清记录完整

⏰ 总计：3小时 (符合快速流程≤5小时要求)
```

---

## 7. 实施优先级

### Phase 1: 核心技能优化 (优先级P0)
1. ✅ powerby-product (P1, P2)
2. ✅ powerby-architect (P3, P4)
3. ✅ powerby-engineer (P5, P6)

### Phase 2: 指令模板更新 (优先级P1)
1. ✅ powerby-define.md
2. ✅ powerby-research.md
3. ✅ powerby-design.md
4. ✅ powerby-plan.md
5. ✅ powerby-implement.md
6. ✅ powerby-review.md
7. ✅ powerby-quick.md

### Phase 3: 补充技能优化 (优先级P2)
1. ✅ powerby-code-review (P7)
2. ✅ powerby-command (指令注册)
3. ✅ 其他辅助技能

---

## 8. 核心改进点总结

### 8.1 统一执行模式
所有P阶段都遵循：
```
1 (拆解任务) → N (分步执行) → 验收通过
```

### 8.2 标准话术
每个技能进入新阶段时都使用：
```
"理解。我将帮助您执行P{X}阶段。按照Px执行协议，我先拆解本阶段的子任务清单..."
```

### 8.3 增量执行
- 完成一个子任务标记[x]
- 避免大爆炸式一次性输出
- 保持执行过程可追溯

### 8.4 最小侵入式
- 不改变核心逻辑
- 只在现有框架上增加抽象约束
- 保持技能个性化和灵活性

---

## 9. 验证标准

### 9.1 检查清单
- [ ] 每个P阶段都有任务拆解步骤
- [ ] 标准话术已添加到技能描述
- [ ] 分步执行模式替代循环/一次性输出
- [ ] 所有指令模板已更新
- [ ] 快速流程同样应用1+N模式

### 9.2 测试场景
1. **标准流程测试**:
   - 使用powerby-product执行P1
   - 验证任务拆解→分步执行流程

2. **快速流程测试**:
   - 使用powerby-quick执行快速流程
   - 验证粗颗粒度任务拆解

3. **全链路测试**:
   - P1→P7完整流程
   - 验证所有阶段都遵循1+N模式

---

## 10. 预期收益

### 10.1 执行习惯改进
✅ **告别大爆炸式交付**
- AI改为分步骤、增量式完成
- 每次只专注一个子任务

✅ **增强可追溯性**
- 每个任务的完成都有记录
- 便于复盘和改进

✅ **提高专注度**
- 减少上下文切换成本
- 明确执行优先级

### 10.2 质量保证
✅ **降低遗漏风险**
- 通过拆解确保覆盖所有必要工作
- 清单化管理避免遗忘

✅ **便于协作**
- 团队成员清楚当前进度
- 任务分配更明确

✅ **支持迭代优化**
- 记录预估vs实际时间
- 持续改进执行效率

---

## 📚 相关文档

- [PowerBy生命周期框架](./powerby-lifecycle-framework.md)
- [Px执行协议实施指南](./PX_EXECUTION_PROTOCOL_IMPLEMENTATION_GUIDE.md) (已删除，遵循最小侵入原则)
- [P0+P1流程合并优化方案](./P0_P1_MERGE_OPTIMIZATION_PLAN.md)

---

**维护者**: 流程维护者 (Process Maintainer)
**最后更新**: 2025-12-19
**版本**: v1.0.0
